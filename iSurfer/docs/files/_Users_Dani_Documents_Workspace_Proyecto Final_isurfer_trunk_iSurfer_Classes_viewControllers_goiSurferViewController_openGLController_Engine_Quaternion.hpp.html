<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>&#x2F;Users&#x2F;Dani&#x2F;Documents&#x2F;Workspace&#x2F;Proyecto Final&#x2F;isurfer&#x2F;trunk&#x2F;iSurfer&#x2F;Classes&#x2F;viewControllers&#x2F;goiSurferViewController&#x2F;openGLController&#x2F;Engine&#x2F;Quaternion.hpp - iSurfer</title>
    <link rel="stylesheet" href="http:&#x2F;&#x2F;yui.yahooapis.com&#x2F;3.8.0pr2&#x2F;build&#x2F;cssgrids&#x2F;cssgrids-min.css">
    <link rel="stylesheet" href="..&#x2F;assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="..&#x2F;assets/css/main.css" id="site_styles">
    <link rel="shortcut icon" type="image/png" href="..&#x2F;assets/favicon.png">
    <script src="http:&#x2F;&#x2F;yui.yahooapis.com&#x2F;combo?3.8.0pr2&#x2F;build&#x2F;yui&#x2F;yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
            
                <h1><img src=".&#x2F;..&#x2F;resources&#x2F;images&#x2F;Imaginary_lemon_mini.jpg" title="iSurfer"></h1>
            
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: 3.0.0</em>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
    <h2 class="off-left">APIs</h2>
    <div id="api-tabview" class="tabview">
        <ul class="tabs">
            <li><a href="#api-classes">Classes</a></li>
            <li><a href="#api-modules">Modules</a></li>
        </ul>

        <div id="api-tabview-filter">
            <input type="search" id="api-filter" placeholder="Type to filter APIs">
        </div>

        <div id="api-tabview-panel">
            <ul id="api-classes" class="apis classes">
            
                <li><a href="..&#x2F;classes/ApplicationEngine.html">ApplicationEngine</a></li>
            
                <li><a href="..&#x2F;classes/Compiler.html">Compiler</a></li>
            
                <li><a href="..&#x2F;classes/Error.html">Error</a></li>
            
                <li><a href="..&#x2F;classes/exception.html">exception</a></li>
            
                <li><a href="..&#x2F;classes/expressionT.html">expressionT</a></li>
            
                <li><a href="..&#x2F;classes/Fragment_Shader.html">Fragment_Shader</a></li>
            
                <li><a href="..&#x2F;classes/genlib.html">genlib</a></li>
            
                <li><a href="..&#x2F;classes/Matrix.html">Matrix</a></li>
            
                <li><a href="..&#x2F;classes/ParametricEquations.html">ParametricEquations</a></li>
            
                <li><a href="..&#x2F;classes/ParametricSurface.html">ParametricSurface</a></li>
            
                <li><a href="..&#x2F;classes/parser.html">parser</a></li>
            
                <li><a href="..&#x2F;classes/programData.html">programData</a></li>
            
                <li><a href="..&#x2F;classes/QuaternionT.html">QuaternionT</a></li>
            
                <li><a href="..&#x2F;classes/ScannerADT.html">ScannerADT</a></li>
            
                <li><a href="..&#x2F;classes/simpio.html">simpio</a></li>
            
                <li><a href="..&#x2F;classes/strlib.html">strlib</a></li>
            
                <li><a href="..&#x2F;classes/surfaceRender.html">surfaceRender</a></li>
            
                <li><a href="..&#x2F;classes/Vector.html">Vector</a></li>
            
                <li><a href="..&#x2F;classes/Vertex_Shader.html">Vertex_Shader</a></li>
            
                <li><a href="..&#x2F;classes/Wire_Fragment_Shader.html">Wire_Fragment_Shader</a></li>
            
                <li><a href="..&#x2F;classes/Wire_Vertex_Shader.html">Wire_Vertex_Shader</a></li>
            
            </ul>

            <ul id="api-modules" class="apis modules">
            
                <li><a href="..&#x2F;modules/Engine.html">Engine</a></li>
            
                <li><a href="..&#x2F;modules/OpenGL.html">OpenGL</a></li>
            
                <li><a href="..&#x2F;modules/Parser.html">Parser</a></li>
            
                <li><a href="..&#x2F;modules/Surface.html">Surface</a></li>
            
            </ul>
        </div>
    </div>
</div>

            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
        Show:
        <label for="api-show-inherited">
            <input type="checkbox" id="api-show-inherited" checked>
            Inherited
        </label>

        <label for="api-show-protected">
            <input type="checkbox" id="api-show-protected">
            Protected
        </label>

        <label for="api-show-private">
            <input type="checkbox" id="api-show-private">
            Private
        </label>
        <label for="api-show-deprecated">
            <input type="checkbox" id="api-show-deprecated">
            Deprecated
        </label>

    </div>


            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
                        <h1 class="file-heading">File: &#x2F;Users&#x2F;Dani&#x2F;Documents&#x2F;Workspace&#x2F;Proyecto Final&#x2F;isurfer&#x2F;trunk&#x2F;iSurfer&#x2F;Classes&#x2F;viewControllers&#x2F;goiSurferViewController&#x2F;openGLController&#x2F;Engine&#x2F;Quaternion.hpp</h1>

<div class="file">
    <pre class="code prettyprint linenums">
#pragma once
#include &quot;Matrix.hpp&quot;

&#x2F;**
 * File: Quaternion.hpp
 * Version: 1.0
 * @module Engine
 *&#x2F;

&#x2F;** 
 *Last modified on February 13 2012 by dazar
 * -----------------------------------------------------
 * This interface provides access to a Quaternion library.
 * It is based on the book &quot;iPhone 3D Programming&quot;.
 * 
 * @class QuaternionT
 *&#x2F;


template &lt;typename T&gt;
struct QuaternionT {
    T x;
    T y;
    T z;
    T w;
    
    QuaternionT();
    QuaternionT(T x, T y, T z, T w);
    
    QuaternionT&lt;T&gt; Slerp(T mu, const QuaternionT&lt;T&gt;&amp; q) const;
    QuaternionT&lt;T&gt; Rotated(const QuaternionT&lt;T&gt;&amp; b) const;
    QuaternionT&lt;T&gt; Scaled(T scale) const;
    T Dot(const QuaternionT&lt;T&gt;&amp; q) const;
    Matrix3&lt;T&gt; ToMatrix() const;
    Vector4&lt;T&gt; ToVector() const;
    QuaternionT&lt;T&gt; operator-(const QuaternionT&lt;T&gt;&amp; q) const;
    QuaternionT&lt;T&gt; operator+(const QuaternionT&lt;T&gt;&amp; q) const;
    bool operator==(const QuaternionT&lt;T&gt;&amp; q) const;
    bool operator!=(const QuaternionT&lt;T&gt;&amp; q) const;
    
    void Normalize();
    void Rotate(const QuaternionT&lt;T&gt;&amp; q);
    
    static QuaternionT&lt;T&gt; CreateFromVectors(const Vector3&lt;T&gt;&amp; v0, const Vector3&lt;T&gt;&amp; v1);
    static QuaternionT&lt;T&gt; CreateFromAxisAngle(const Vector3&lt;T&gt;&amp; axis, float radians);
};

template &lt;typename T&gt;
inline QuaternionT&lt;T&gt;::QuaternionT() : x(0), y(0), z(0), w(1)
{
}

template &lt;typename T&gt;
inline QuaternionT&lt;T&gt;::QuaternionT(T x, T y, T z, T w) : x(x), y(y), z(z), w(w)
{
}

&#x2F;&#x2F; Ken Shoemake&#x27;s famous method.
template &lt;typename T&gt;
inline QuaternionT&lt;T&gt; QuaternionT&lt;T&gt;::Slerp(T t, const QuaternionT&lt;T&gt;&amp; v1) const
{
    const T epsilon = 0.0005f;
    T dot = Dot(v1);
    
    if (dot &gt; 1 - epsilon) {
        QuaternionT&lt;T&gt; result = v1 + (*this - v1).Scaled(t);
        result.Normalize();
        return result;
    }
    
    if (dot &lt; 0)
        dot = 0;
    
    if (dot &gt; 1)
        dot = 1;
    
    T theta0 = std::acos(dot);
    T theta = theta0 * t;
    
    QuaternionT&lt;T&gt; v2 = (v1 - Scaled(dot));
    v2.Normalize();
    
    QuaternionT&lt;T&gt; q = Scaled(std::cos(theta)) + v2.Scaled(std::sin(theta));
	q.Normalize();
	return q;
}

template &lt;typename T&gt;
inline QuaternionT&lt;T&gt; QuaternionT&lt;T&gt;::Rotated(const QuaternionT&lt;T&gt;&amp; b) const
{
    QuaternionT&lt;T&gt; q;
    q.w = w * b.w - x * b.x - y * b.y - z * b.z;
    q.x = w * b.x + x * b.w + y * b.z - z * b.y;
    q.y = w * b.y + y * b.w + z * b.x - x * b.z;
    q.z = w * b.z + z * b.w + x * b.y - y * b.x;
    q.Normalize();
    return q;
}

template &lt;typename T&gt;
inline QuaternionT&lt;T&gt; QuaternionT&lt;T&gt;::Scaled(T s) const
{
    return QuaternionT&lt;T&gt;(x * s, y * s, z * s, w * s);
}

template &lt;typename T&gt;
inline T QuaternionT&lt;T&gt;::Dot(const QuaternionT&lt;T&gt;&amp; q) const
{
    return x * q.x + y * q.y + z * q.z + w * q.w;
}

template &lt;typename T&gt;
inline Matrix3&lt;T&gt; QuaternionT&lt;T&gt;::ToMatrix() const
{
    const T s = 2;
    T xs, ys, zs;
    T wx, wy, wz;
    T xx, xy, xz;
    T yy, yz, zz;
    xs = x * s;  ys = y * s;  zs = z * s;
    wx = w * xs; wy = w * ys; wz = w * zs;
    xx = x * xs; xy = x * ys; xz = x * zs;
    yy = y * ys; yz = y * zs; zz = z * zs;
    Matrix3&lt;T&gt; m;
    m.x.x = 1 - (yy + zz); m.y.x = xy - wz;  m.z.x = xz + wy;
    m.x.y = xy + wz; m.y.y = 1 - (xx + zz); m.z.y = yz - wx;
    m.x.z = xz - wy; m.y.z = yz + wx;  m.z.z = 1 - (xx + yy);
    return m;
}

template &lt;typename T&gt;
inline Vector4&lt;T&gt; QuaternionT&lt;T&gt;::ToVector() const
{
    return Vector4&lt;T&gt;(x, y, z, w);
}

template &lt;typename T&gt;
QuaternionT&lt;T&gt; QuaternionT&lt;T&gt;::operator-(const QuaternionT&lt;T&gt;&amp; q) const
{
    return QuaternionT&lt;T&gt;(x - q.x, y - q.y, z - q.z, w - q.w);
}

template &lt;typename T&gt;
QuaternionT&lt;T&gt; QuaternionT&lt;T&gt;::operator+(const QuaternionT&lt;T&gt;&amp; q) const
{
    return QuaternionT&lt;T&gt;(x + q.x, y + q.y, z + q.z, w + q.w);
}

template &lt;typename T&gt;
bool QuaternionT&lt;T&gt;::operator==(const QuaternionT&lt;T&gt;&amp; q) const
{
    return x == q.x &amp;&amp; y == q.y &amp;&amp; z == q.z &amp;&amp; w == q.w;
}

template &lt;typename T&gt;
bool QuaternionT&lt;T&gt;::operator!=(const QuaternionT&lt;T&gt;&amp; q) const
{
    return !(*this == q);
}

&#x2F;&#x2F; Compute the quaternion that rotates from a to b, avoiding numerical instability.
&#x2F;&#x2F; Taken from &quot;The Shortest Arc Quaternion&quot; by Stan Melax in &quot;Game Programming Gems&quot;.
template &lt;typename T&gt;
inline QuaternionT&lt;T&gt; QuaternionT&lt;T&gt;::CreateFromVectors(const Vector3&lt;T&gt;&amp; v0, const Vector3&lt;T&gt;&amp; v1)
{
    if (v0 == -v1)
        return QuaternionT&lt;T&gt;::CreateFromAxisAngle(vec3(1, 0, 0), Pi);
    
    Vector3&lt;T&gt; c = v0.Cross(v1);
    T d = v0.Dot(v1);
    T s = std::sqrt((1 + d) * 2);

    QuaternionT&lt;T&gt; q;
    q.x = c.x &#x2F; s;
    q.y = c.y &#x2F; s;
    q.z = c.z &#x2F; s;
    q.w = s &#x2F; 2.0f;
    return q;
}

template &lt;typename T&gt;
inline QuaternionT&lt;T&gt;  QuaternionT&lt;T&gt;::CreateFromAxisAngle(const Vector3&lt;T&gt;&amp; axis, float radians)
{
    QuaternionT&lt;T&gt; q;
    q.w = std::cos(radians &#x2F; 2);
    q.x = q.y = q.z = std::sin(radians &#x2F; 2);
    q.x *= axis.x;
    q.y *= axis.y;
    q.z *= axis.z;
    return q;
}

template &lt;typename T&gt;
inline void QuaternionT&lt;T&gt;::Normalize()
{
    *this = Scaled(1 &#x2F; std::sqrt(Dot(*this)));
}

template &lt;typename T&gt;
inline void QuaternionT&lt;T&gt;::Rotate(const QuaternionT&lt;T&gt;&amp; q2)
{
    QuaternionT&lt;T&gt; q;
    QuaternionT&lt;T&gt;&amp; q1 = *this;
    
    q.w = q1.w * q2.w - q1.x * q2.x - q1.y * q2.y - q1.z * q2.z;
    q.x = q1.w * q2.x + q1.x * q2.w + q1.y * q2.z - q1.z * q2.y;
    q.y = q1.w * q2.y + q1.y * q2.w + q1.z * q2.x - q1.x * q2.z;
    q.z = q1.w * q2.z + q1.z * q2.w + q1.x * q2.y - q1.y * q2.x;
    
    q.Normalize();
    *this = q;
}

typedef QuaternionT&lt;float&gt; Quaternion;

    </pre>
</div>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="..&#x2F;assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="..&#x2F;assets/js/yui-prettify.js"></script>
<script src="..&#x2F;assets/../api.js"></script>
<script src="..&#x2F;assets/js/api-filter.js"></script>
<script src="..&#x2F;assets/js/api-list.js"></script>
<script src="..&#x2F;assets/js/api-search.js"></script>
<script src="..&#x2F;assets/js/apidocs.js"></script>
</body>
</html>
